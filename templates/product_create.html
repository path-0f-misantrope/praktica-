{{define "content_create"}}

<div class="card">
    <h2>‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç</h2>

    {{if .Error}}
    <div class="alert alert-error">{{.Error}}</div>
    {{end}}

    <form action="/products/create" method="POST">
        <div class="form-group">
            <label for="product_name">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ *</label>
            <input type="text" id="product_name" name="product_name" required>
        </div>

        <div class="form-group">
            <label for="material_id">–ú–∞—Ç–µ—Ä–∏–∞–ª *</label>
            <select id="material_id" name="material_id" required>
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª...</option>
                {{range .Materials}}
                <option value="{{.ID}}">{{.MaterialName}}</option>
                {{end}}
            </select>
        </div>

        <div class="form-group">
            <label for="type_id">–¢–∏–ø –ø—Ä–æ–¥—É–∫—Ü–∏–∏ *</label>
            <select id="type_id" name="type_id" required>
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø...</option>
                {{range .Types}}
                <option value="{{.ID}}">{{.TypeName}}</option>
                {{end}}
            </select>
        </div>

        <div class="form-group">
            <label for="min_price">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ (‚ÇΩ)</label>
            <input type="number" id="min_price" name="min_price" step="0.01" placeholder="0.00">
        </div>

        <div class="form-group">
            <label for="article">–ê—Ä—Ç–∏–∫—É–ª</label>
            <input type="text" id="article" name="article" placeholder="ART-001">
        </div>

        <div class="form-group">
            <label>–¶–µ—Ö–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞</label>
            <div id="workshops-container"></div>

            <button type="button" class="btn btn-success" onclick="addWorkshop()">
                ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ü–µ—Ö
            </button>
        </div>

        <div class="actions">
            <button type="submit" class="btn btn-primary">üíæ –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç</button>
            <a href="/" class="btn">‚ùå –û—Ç–º–µ–Ω–∞</a>
        </div>
    </form>
</div>

<script>
    let workshopCount = 0;

    function addWorkshop() {
        workshopCount++;

        const container = document.getElementById("workshops-container");
        const wrapper = document.createElement("div");
        wrapper.className = "form-group";
        wrapper.style.display = "flex";
        wrapper.style.gap = "10px";
        wrapper.style.alignItems = "center";

        // –§–æ—Ä–º–∏—Ä—É–µ–º HTML —á–µ—Ä–µ–∑ –æ–±—ã—á–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏, –±–µ–∑ JS-—à–∞–±–ª–æ–Ω–æ–≤
        wrapper.innerHTML = `
            <select name="workshop_id_${workshopCount}" style="flex:2">
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ü–µ—Ö...</option>
                ${workshopsOptionsHTML()}
            </select>

            <input type="number" name="production_time_${workshopCount}"
                   step="0.1" placeholder="–í—Ä–µ–º—è (—á–∞—Å—ã)" style="flex:1">

            <button type="button" class="btn btn-danger">‚úï</button>
        `;

        wrapper.querySelector(".btn-danger").onclick = () => wrapper.remove();

        container.appendChild(wrapper);
    }

    // –ü–µ—Ä–µ–¥–∞—ë–º Go-—à–∞–±–ª–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ JS –∫–∞–∫ —Å—Ç—Ä–æ–∫—É
    function workshopsOptionsHTML() {
        return `
            {{range .Workshops}}
            <option value="{{.ID}}">{{.Name}}</option>
            {{end}}
        `;
    }
</script>

{{end}}
